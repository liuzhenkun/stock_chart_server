
// 模拟前端调用LIB
// 页面加载完成立即执行draw函数
window.onload = draw;

// If the browser dosen't support canvas
function showError() {
  'use strict';
  console.log('The current browser doesn\'t support canvas!');
} // end function showError

function draw() {
  // ***************************************************************************************************
  // **********************************Prepare to draw kline*****************************************
  // ***************************************************************************************************
  // Get the canvas object from client
  'use strict';
  var pr = window.devicePixelRatio,
    // predefine kline variables
    canvasNewKlineWebBig = document.getElementById("myCanvasNewKlineWebBig"),
    canvasNewKlineWebSmall = document.getElementById("myCanvasNewKlineWebSmall"),
    canvasKlineWeb = document.getElementById("myCanvasKlineWeb"),
    canvasGupiao123Kline = document.getElementById("myCanvasGupiao123Kline"),
    canvasGupiao123BigKline = document.getElementById("myCanvasGupiao123BigKline"),
    canvasGupiao123V3Kline = document.getElementById("myCanvasGupiao123V3Kline"),
    canvasGupiao123V3BigKline = document.getElementById("myCanvasGupiao123V3BigKline"),
    stockId = '600000',
    wtypeKline = 'web',
    ktype = 1,
    scaleK = 1,
    kSize = 30,
    num = 0,
    drawVolAvgLineFlag = false,
    dataKline = '',
    // predefine kline variables
    canvasNewMlineWebBig = document.getElementById("myCanvasNewMlineWebBig"),
    canvasNewMlineWebSmall = document.getElementById("myCanvasNewMlineWebSmall"),
    canvasNewWebAppMainPage = document.getElementById("myCanvasNewWebAppMainPage"),
    canvasNewWebAppTrend = document.getElementById("myCanvasNewWebAppTrend"),
    canvasMlineWeb = document.getElementById("myCanvasMlineWeb"),
    canvasMlineGupiao123 = document.getElementById("myCanvasMlineGupiao123"),
    canvasMlineGupiao123Big = document.getElementById("myCanvasMlineGupiao123Big"),
    canvasMlineGupiao123V3 = document.getElementById("myCanvasMlineGupiao123V3"),
    canvasMlineGupiao123V3Big = document.getElementById("myCanvasMlineGupiao123V3Big"),
    wtypeMline = 'web',
    scaleM = 1,
    mtype = 0,
    dataMline = '';

  if (canvasNewKlineWebBig && canvasNewKlineWebBig.getContext && ((pr && pr >= 1.5) || window.screen.width >= 480)) {
    // 根据像素比设置逻辑宽度和高度， 而实际渲染区域大小固定
    canvasNewKlineWebBig.setAttribute('height', parseInt(470 * pr, 10));
    canvasNewKlineWebBig.setAttribute('width', parseInt(610 * pr, 10));
    canvasNewKlineWebBig.style.height = '470px';
    canvasNewKlineWebBig.style.width = '610px';
    wtypeKline = 'webAppBig';
   /**
    * 供前端调用绘制K线图
    * @param Object canvas 画图对象
    * @param String wtype  产品类型，web，wap，mms，lenovo
    * @param Object dataKline   K线JOSN格式数据(日资金流向数据, 包含其中)
    * @param Object fundDailyDataKline  日资金流向数据
    * @param Integer kSize K线大小
    * @param Integer ktype K线类型
    * @param Integer scale 图片缩放的倍数
    * @param Boolean drawVolAvgLineFlag 是否画成交量均线
    */
    // data = JSON.parse('{"stockInfo":{"dataKey":["stockID","orgStockID","stockName","marketType","stockType","stockStatus","is_index"],"dataValue":["600000","600000","浦发银行","SH",",HA,","0","N"]},"kLine":{"dataKey":["time","high","open","low","close","volum","amount","averagePrice","averageVolum","fundDailyValue"],"dataValue":[["20120903",7.63,7.63,7.53,7.58,553933,419440943,[7.59,7.54,7.6],[461271,415895,468909],0],["20120904",7.59,7.56,7.43,7.46,443613,0,[7.56,7.53,7.6],[440466,423987,467566],0],["20120905",7.45,7.44,7.28,7.32,731359,536590326,[7.52,7.51,7.59],[509899,461797,476084],0],["20120906",7.39,7.34,7.3,7.38,383702,281996026,[7.47,7.5,7.59],[497031,463801,478758],0],["20120907",7.78,7.42,7.4,7.6,1459719,1108956749,[7.47,7.51,7.6],[714465,572809,507915],0],["20120910",7.61,7.59,7.53,7.56,637990,482615575,[7.46,7.53,7.6],[731276,596274,508467],0],["20120911",7.54,7.54,7.43,7.49,509813,381041955,[7.47,7.52,7.59],[744516,592491,502088],0],["20120912",7.56,7.53,7.42,7.48,411993,308089937,[7.5,7.51,7.59],[680643,595271,495064],0],["20120913",7.5,7.47,7.44,7.45,285985,213621171,[7.52,7.49,7.58],[661100,579065,479449],0],["20120914",7.56,7.5,7.44,7.52,605539,454887764,[7.5,7.48,7.57],[490264,602364,484952],0],["20120917",7.52,7.52,7.4,7.41,394957,294478234,[7.47,7.47,7.56],[441657,586467,482647],0],["20120918",7.4,7.39,7.34,7.35,295564,217783066,[7.44,7.46,7.55],[398807,571662,480861],0],["20120919",7.38,7.35,7.33,7.34,353162,259404103,[7.41,7.46,7.53],[387041,533842,474693],0],["20120920",7.34,7.32,7.22,7.23,480720,349808077,[7.37,7.44,7.52],[425988,543544,479887],0],["20120921",7.26,7.22,7.18,7.21,375406,271098089,[7.31,7.4,7.5],[379961,435112,476806],0],["20120924",7.21,7.18,7.11,7.17,442806,316830860,[7.26,7.37,7.48],[389531,415594,475806],0],["20120925",7.18,7.16,7.13,7.16,235284,168346308,[7.22,7.33,7.46],[377475,388141,470400],0],["20120926",7.18,7.15,7.1,7.11,283442,202126616,[7.18,7.3,7.44],[363531,375286,449997],0],["20120927",7.36,7.11,7.1,7.32,745652,540842730,[7.19,7.28,7.43],[416518,421253,461308],0],["20120928",7.39,7.28,7.24,7.38,629301,460162691,[7.23,7.27,7.43],[467297,423629,471178],0],["20121008",7.42,7.38,7.28,7.32,323245,237702592,[7.26,7.26,7.42],[443384,416458,472940],0],["20121009",7.48,7.35,7.34,7.45,486200,361695652,[7.32,7.27,7.42],[493568,435521,477057],0],["20121010",7.46,7.43,7.4,7.44,271473,201761964,[7.38,7.28,7.42],[491174,427352,474330],0],["20121011",7.43,7.41,7.37,7.41,295642,218797754,[7.4,7.3,7.41],[401172,408845,472063],0],["20121012",7.5,7.43,7.41,7.45,379537,283061227,[7.41,7.32,7.41],[351219,409258,472393],0],["20121015",7.47,7.46,7.37,7.41,222493,164793074,[7.43,7.35,7.41],[331069,387226,466365],0],["20121016",7.52,7.41,7.39,7.46,439525,328313924,[7.43,7.38,7.41],[321734,407651,462761],0],["20121017",7.58,7.48,7.44,7.55,526584,395714435,[7.46,7.42,7.41],[372756,431965,467507],0],["20121018",7.65,7.55,7.54,7.62,513973,390882250,[7.5,7.45,7.41],[416422,408797,469705],0],["20121019",7.63,7.62,7.55,7.58,401855,305185395,[7.52,7.47,7.41],[420886,386052,470682],0]]},"date":"20121019","openPrice":7.62,"closePrice":7.62,"version":"1.0"}');
    dataKline = JSON.parse('{"stockInfo":{"dataKey":["stockID","orgStockID","stockName","marketType","stockType","stockStatus","is_index"],"dataValue":["600000","600000","浦发银行","SH",",HA,","0","N"]},"kLine":{"dataKey":["time","high","open","low","close","volum","amount","averagePrice","averageVolum","fundDailyValue"],"dataValue":[["20120903",7.63,7.63,7.53,7.58,553933,419440943,[7.59,7.54,7.6],[461271,415895,468909],12596338],["20120904",7.59,7.56,7.43,7.46,443613,332534233,[7.56,7.53,7.6],[440466,423987,467566],-21454712],["20120905",7.45,7.44,7.28,7.32,731359,536590326,[7.52,7.51,7.59],[509899,461797,476084],12596338],["20120906",7.39,7.34,7.3,7.38,383702,281996026,[7.47,7.5,7.59],[497031,463801,478758],12596338],["20120907",7.78,7.42,7.4,7.6,1459719,1108956749,[7.47,7.51,7.6],[714465,572809,507915],-214547],["20120910",7.61,7.59,7.53,7.56,637990,482615575,[7.46,7.53,7.6],[731276,596274,508467],-21484712],["20120911",7.54,7.54,7.43,7.49,509813,381041955,[7.47,7.52,7.59],[744516,592491,502088],12596338],["20120912",7.56,7.53,7.42,7.48,411993,308089937,[7.5,7.51,7.59],[680643,595271,495064],11454712],["20120913",7.5,7.47,7.44,7.45,285985,213621171,[7.52,7.49,7.58],[661100,579065,479449],12536338],["20120914",7.56,7.5,7.44,7.52,605539,454887764,[7.5,7.48,7.57],[490264,602364,484952],-21454312],["20120917",7.52,7.52,7.4,7.41,394957,294478234,[7.47,7.47,7.56],[441657,586467,482647],12596338],["20120918",7.4,7.39,7.34,7.35,295564,217783066,[7.44,7.46,7.55],[398807,571662,480861],12596338],["20120919",7.38,7.35,7.33,7.34,353162,259404103,[7.41,7.46,7.53],[387041,533842,474693],12596338],["20120920",7.34,7.32,7.22,7.23,480720,349808077,[7.37,7.44,7.52],[425988,543544,479887],12596338],["20120921",7.26,7.22,7.18,7.21,375406,271098089,[7.31,7.4,7.5],[379961,435112,476806],12596338],["20120924",7.21,7.18,7.11,7.17,442806,316830860,[7.26,7.37,7.48],[389531,415594,475806],12596338],["20120925",7.18,7.16,7.13,7.16,235284,168346308,[7.22,7.33,7.46],[377475,388141,470400],12596338],["20120926",7.18,7.15,7.1,7.11,283442,202126616,[7.18,7.3,7.44],[363531,375286,449997],12596338],["20120927",7.36,7.11,7.1,7.32,745652,540842730,[7.19,7.28,7.43],[416518,421253,461308],12596338],["20120928",7.39,7.28,7.24,7.38,629301,460162691,[7.23,7.27,7.43],[467297,423629,471178],12596338],["20121008",7.42,7.38,7.28,7.32,323245,237702592,[7.26,7.26,7.42],[443384,416458,472940],12596338],["20121009",7.48,7.35,7.34,7.45,486200,361695652,[7.32,7.27,7.42],[493568,435521,477057],12596338],["20121010",7.46,7.43,7.4,7.44,271473,201761964,[7.38,7.28,7.42],[491174,427352,474330],12596338],["20121011",7.43,7.41,7.37,7.41,295642,218797754,[7.4,7.3,7.41],[401172,408845,472063],12596338],["20121012",7.5,7.43,7.41,7.45,379537,283061227,[7.41,7.32,7.41],[351219,409258,472393],12596338],["20121015",7.47,7.46,7.37,7.41,222493,164793074,[7.43,7.35,7.41],[331069,387226,466365],12596338],["20121016",7.52,7.41,7.39,7.46,439525,328313924,[7.43,7.38,7.41],[321734,407651,462761],12596338],["20121017",7.58,7.48,7.44,7.55,526584,395714435,[7.46,7.42,7.41],[372756,431965,467507],12596338],["20121018",7.65,7.55,7.54,7.62,513973,390882250,[7.5,7.45,7.41],[416422,408797,469705],12596338],["20121019",7.63,7.62,7.55,7.58,401855,305185395,[7.52,7.47,7.41],[420886,386052,470682],12596338]]},"date":"20121019","openPrice":7.62,"closePrice":7.62,"version":"1.0"}');
    startDrawKline(canvasNewKlineWebBig, wtypeKline, dataKline, kSize, ktype, scaleK, drawVolAvgLineFlag);
  } else {
    showError();
  }

  if (canvasNewKlineWebSmall && canvasNewKlineWebSmall.getContext && ((pr && pr >= 1.5) || window.screen.width >= 480)) {
    canvasNewKlineWebSmall.setAttribute('height', parseInt(270 * pr, 10));
    canvasNewKlineWebSmall.setAttribute('width', parseInt(610 * pr, 10));
    canvasNewKlineWebSmall.style.height = '270px';
    canvasNewKlineWebSmall.style.width = '610px';
    wtypeKline = 'webAppSmall';
    startDrawKline(canvasNewKlineWebSmall, wtypeKline, dataKline, kSize, ktype, scaleK, drawVolAvgLineFlag);
  } else {
    showError();
  }

  if (canvasKlineWeb.getContext) {
    canvasKlineWeb.setAttribute('height', parseInt(265 * pr, 10));
    canvasKlineWeb.setAttribute('width', parseInt(300 * pr, 10));
    canvasKlineWeb.style.height = '265px';
    canvasKlineWeb.style.width = '300px';
    wtypeKline = 'web';
    startDrawKline(canvasKlineWeb, wtypeKline, dataKline, kSize, ktype, scaleK, drawVolAvgLineFlag);
  } else {
    showError();
  }

  if (canvasGupiao123Kline.getContext) {
    canvasGupiao123Kline.setAttribute('height', parseInt(130 * pr, 10));
    canvasGupiao123Kline.setAttribute('width', parseInt(220 * pr, 10));
    canvasGupiao123Kline.style.height = '130px';
    canvasGupiao123Kline.style.width = '220px';
    wtypeKline = 'gupiao123';
    startDrawKline(canvasGupiao123Kline, wtypeKline, dataKline, kSize, ktype, scaleK, drawVolAvgLineFlag);
  } else {
    showError();
  }

  if (canvasGupiao123BigKline.getContext) {
    canvasGupiao123BigKline.setAttribute('height', parseInt(273 * pr, 10));
    canvasGupiao123BigKline.setAttribute('width', parseInt(400 * pr, 10));
    canvasGupiao123BigKline.style.height = '273px';
    canvasGupiao123BigKline.style.width = '400px';
    wtypeKline = 'gupiao123Big';
    startDrawKline(canvasGupiao123BigKline, wtypeKline, dataKline, kSize, ktype, scaleK, drawVolAvgLineFlag);
  } else {
    showError();
  }

  if (canvasGupiao123V3Kline && canvasGupiao123V3Kline.getContext && ((pr && pr >= 1.5) || window.screen.width >= 480)) {
    canvasGupiao123V3Kline.setAttribute('height', parseInt(180 * pr, 10));
    canvasGupiao123V3Kline.setAttribute('width', parseInt(300 * pr, 10));
    canvasGupiao123V3Kline.style.height = '180px';
    canvasGupiao123V3Kline.style.width = '300px';
    wtypeKline = 'gupiao123V3';
    startDrawKline(canvasGupiao123V3Kline, wtypeKline, dataKline, kSize, ktype, scaleK, drawVolAvgLineFlag);
  } else {
    showError();
  }

  if (canvasGupiao123V3BigKline.getContext) {
    canvasGupiao123V3BigKline.setAttribute('height', parseInt(360 * pr, 10));
    canvasGupiao123V3BigKline.setAttribute('width', parseInt(600 * pr, 10));
    canvasGupiao123V3BigKline.style.height = '360px';
    canvasGupiao123V3BigKline.style.width = '600px';
    wtypeKline = 'gupiao123V3Big';
    startDrawKline(canvasGupiao123V3BigKline, wtypeKline, dataKline, kSize, ktype, scaleK, drawVolAvgLineFlag);
  } else {
    showError();
  }


  // ***************************************************************************************************
  // ****************************************Prepare to draw mline***********************************
  // ***************************************************************************************************
  // If the browser support canvas
  if (canvasNewMlineWebBig && canvasNewMlineWebBig.getContext && ((pr && pr >= 1.5) || window.screen.width >= 480)) {
    canvasNewMlineWebBig.setAttribute('height', parseInt(466 * pr, 10));
    canvasNewMlineWebBig.setAttribute('width', parseInt(595 * pr, 10));
    canvasNewMlineWebBig.style.height = '466px';
    canvasNewMlineWebBig.style.width = '595px';
    wtypeMline = 'webAppBig';
  /**
   * 供前端调用绘制分时图
   * @param Object canvas   画图对象
   * @param String wtype    产品类型，web，wap，mms，lenovo
   * @param Object dataMline    分时JSON格式数据(日资金流向数据, 包含其中)
   * @param Integer mType   显示头部名称(0)或者百分比(1)
   * @param Integer scaleM 图片缩放的倍数
   */
    // 包含了资金流向数据的M数据结合
    // dataMline = JSON.parse('{"stockInfo":{"dataKey":["stockID","orgStockID","stockName","marketType","stockType","stockStatus","is_index"],"dataValue":["600000","600000","浦发银行","SH",",HA,","0","N"]},"mUnit":{"dataKey":["time","price","volum","amount","fundDailyValue"],"dataValue":[["093057",7.61,2469,1881706,-3182385],["093157",7.61,4336,3302757,-3182385],["093257",7.62,6012,4579804,-3182385],["093357",7.62,9904,7546587,-3182385],["093457",7.62,12282,9357191,-3182385],["093557",7.61,15043,11459225,-3182385],["093657",7.61,17976,13690690,-3182385],["093757",7.6,19331,14720810,-3182385],["093857",7.61,21671,16500517,-3182385],["093957",7.62,22245,16937978,-3182385],["094057",7.61,23841,18153200,-3182385],["094157",7.62,25982,19783036,-3182385],["094257",7.61,27628,21036421,-3182385],["094357",7.6,34021,25899938,-3182385],["094457",7.6,38905,29611247,-3182385],["094557",7.6,41857,31856401,-3182385],["094657",7.6,45510,34632448,-3182385],["094757",7.6,47298,35990154,-3182385],["094857",7.59,49357,37553153,-3182385],["094957",7.59,51213,38962563,-3182385],["095057",7.59,51577,39238618,-3182385],["095157",7.59,53741,40881081,-3182385]]},"previous":"1A0001","next":"2A0001","date":"20121019","openPrice":7.62,"closePrice":7.62,"version":"1.0"}');
    dataMline = JSON.parse('{"stockInfo":{"dataKey":["stockID","orgStockID","stockName","marketType","stockType","stockStatus","is_index"],"dataValue":["1B0007","000010","\u4e0a\u8bc1180","SH",",UN,","0","Y"]},"mUnit":{"dataKey":["time","price","volum","amount","fundDailyValue"],"dataValue":[["093059",5485.21,42076300,412456732,0],["093159",5487.69,55706700,554599269,0],["093259",5487.93,73201700,729387472,0],["093359",5487.25,90030100,903636925,0],["093459",5485.27,107049500,1080188685,0],["093554",5484.18,121223100,1227459126,0],["093659",5482.66,136795100,1396549398,0],["093759",5480.52,154434500,1573204701,0],["093859",5478.9,168279400,1727221895,0],["093955",5479.68,181288800,1872482297,0],["094055",5477.69,193889200,2003314627,0],["094155",5478.92,209558300,2171944689,0],["094255",5479.24,224964400,2338369501,0],["094355",5478.98,240343300,2496509301,0],["094455",5478.98,254590400,2648279845,0],["094555",5477.9,269555700,2804139917,0],["094655",5479.77,282767000,2942386554,0],["094755",5483.13,298655800,3110599928,0],["094855",5481.47,313337000,3270142029,0],["094950",5481.26,329245800,3407910685,0],["095050",5485.36,347123100,3608472659,0],["095155",5490.5,366776800,3809421185,0],["095255",5494.28,385837800,4013307088,0],["095355",5497.04,403473500,4208630025,0],["095450",5499.69,419918900,4377270155,0],["095555",5501.42,441661300,4589234613,0],["095655",5502.31,460346000,4794581716,0],["095755",5502.84,480057000,5000122855,0],["095855",5504.39,501138600,5219591095,0],["095955",5504.69,522005800,5458104681,0],["100055",5503.47,540760600,5670547633,0],["100155",5499.54,559755800,5873914978,0],["100250",5500.55,574676200,6032114710,0],["100355",5496.59,593160600,6227781707,0],["100455",5495.81,611713800,6421640293,0],["100555",5493.58,631032900,6627646534,0],["100655",5492.49,644647900,6773098988,0],["100755",5492.69,658535600,6924197798,0],["100850",5493.56,669938300,7047288723,0],["100955",5492.78,685163000,7207823309,0],["101055",5491.35,697423400,7332679613,0],["101155",5490.47,709174500,7448927111,0],["101255",5489.02,723402000,7598800263,0],["101400",5487.78,738471900,7757155907,0],["101455",5484.64,751487200,7891019527,0],["101550",5487.72,765679500,8041388142,0],["101655",5487.1,779784300,8198063703,0],["101750",5487.1,792796400,8348647337,0],["101855",5487.81,807908800,8505524403,0],["101955",5484.56,819097800,8630906390,0],["102055",5485.61,833537200,8781651207,0],["102155",5482.84,846905100,8915588591,0],["102255",5481.61,859345200,9049443212,0],["102355",5478.4,879171200,9263291142,0],["102455",5479.64,895054100,9435860019,0],["102555",5479.01,908049000,9577477042,0],["102655",5477.39,924121200,9734813665,0],["102750",5475.59,939544400,9875503107,0],["102855",5473.04,953682500,10014218239,0],["102955",5473.76,973630300,10198149752,0],["103055",5469.15,989924100,10372042430,0],["103155",5471.76,1012846000,10604478811,0],["103255",5473.43,1032329700,10802538283,0],["103355",5473.7,1047025500,10957812730,0],["103455",5475.67,1059220700,11084472069,0],["103550",5477.27,1070698700,11192964218,0],["103655",5477.01,1085547400,11338017735,0],["103755",5478.32,1093363100,11424580645,0],["103845",5476.91,1101190400,11510048641,0],["103950",5477,1111494000,11615980256,0],["104055",5479.26,1126201900,11757065723,0],["104155",5482.54,1140642000,11888836747,0],["104250",5484.5,1151775000,12002695519,0],["104355",5485.47,1163010600,12124048111,0],["104455",5485.5,1174080700,12220762995,0],["104555",5485.96,1185057500,12308921850,0],["104655",5483.85,1194195500,12390878533,0],["104755",5482.07,1203078400,12469379184,0],["104850",5481.88,1210362700,12535476663,0],["104955",5482.36,1219956900,12616723504,0],["105050",5480.66,1227090400,12687208350,0],["105150",5478.9,1236874800,12776328374,0],["105255",5477.92,1247416800,12881241653,0],["105355",5476.59,1256094400,12961612278,0],["105450",5476.27,1268513900,13073542156,0],["105550",5475.77,1278546200,13171734072,0],["105656",5475.39,1287763100,13258578264,0],["105750",5473.71,1295525000,13347584790,0],["105850",5475.05,1309432700,13483293260,0],["105950",5477.74,1323134500,13603384907,0],["110056",5481.39,1335732600,13721209608,0],["110156",5478.43,1348635800,13828849634,0],["110256",5476.14,1357444200,13913372824,0],["110351",5472.21,1366784900,14003635478,0],["110446",5471.6,1376597000,14107626217,0],["110551",5469.14,1389574300,14261940431,0],["110656",5465.93,1406519200,14430962798,0],["110756",5465.01,1425092500,14603521142,0],["110856",5465.33,1440976500,14766178853,0],["110956",5461.7,1455161400,14907725802,0],["111056",5458.8,1471311800,15077850845,0],["111156",5462.9,1493438900,15295317856,0],["111256",5463.99,1508947000,15451524283,0],["111356",5461.84,1521442100,15583851090,0],["111456",5461.1,1532434900,15702991683,0],["111556",5460.82,1542942400,15803768721,0],["111656",5461.75,1552744900,15903680212,0],["111756",5460.75,1562369200,15999932700,0],["111851",5459.54,1574381500,16102724956,0],["111956",5460.19,1585072800,16206226305,0],["112056",5456.28,1601736600,16365299534,0],["112156",5454.26,1614600000,16497634612,0],["112256",5449.78,1635933600,16720565110,0],["112356",5447.43,1656188600,16931384312,0],["112456",5441.07,1679872100,17154970408,0],["112556",5438.6,1708318500,17430049343,0],["112656",5438.63,1730340100,17661929071,0],["112756",5437.98,1751528100,17876061246,0],["112856",5436.35,1775040500,18087362009,0],["112956",5435.89,1796464000,18312885641,0],["130057",5432.54,1848260900,18753713486,0],["130157",5430.67,1863503700,18892229567,0],["130257",5429.96,1879258500,19018498053,0],["130357",5428.7,1893561500,19153355465,0],["130457",5427.93,1907057300,19288011495,0],["130552",5427.8,1920025600,19425351482,0],["130657",5427.17,1933416000,19567245975,0],["130757",5426.76,1946458900,19699287949,0],["130857",5426.58,1959267600,19846401642,0],["130952",5422.84,1975015000,20008236583,0],["131052",5419.07,1994380500,20208133831,0],["131157",5415.83,2015907300,20424978640,0],["131257",5414.43,2036005000,20620955132,0],["131357",5417.83,2064167900,20883519421,0],["131452",5416.12,2083021800,21055458681,0],["131547",5415.6,2096893300,21206538953,0],["131657",5416.5,2118246400,21427563281,0],["131757",5412.61,2137577600,21624424165,0],["131857",5409.35,2156306900,21817879120,0],["131947",5404.31,2178226300,22031186342,0],["132052",5398.59,2212974400,22363240750,0],["132157",5395.91,2250247100,22751007038,0],["132257",5391.21,2280915500,23037978445,0],["132357",5391.16,2314624800,23327835161,0],["132447",5388.6,2336354800,23544275649,0],["132552",5387.86,2366327800,23822225873,0],["132657",5391.2,2397795700,24099907922,0],["132757",5392.54,2418099600,24304460069,0],["132857",5394.24,2435227200,24468124125,0],["132947",5397,2450276100,24604378840,0],["133057",5398.78,2473304300,24822834657,0],["133152",5401.31,2489422600,24964188336,0],["133247",5409.53,2513844500,25193543506,0],["133357",5409.81,2533048300,25380401880,0],["133457",5410.01,2547593000,25527186698,0],["133547",5408.86,2558762200,25636757348,0],["133657",5403.23,2582064600,25827839414,0],["133752",5403.8,2597304900,25974213091,0],["133857",5403.01,2609765600,26092325999,0],["133952",5401.39,2619647600,26191951305,0],["134057",5401.74,2633508000,26328786048,0],["134158",5400.05,2646972500,26466706647,0],["134258",5401.97,2658219400,26575134206,0],["134353",5403.03,2671657900,26707748189,0],["134458",5404.41,2687434000,26856290665,0],["134558",5404.15,2701354000,27009910542,0],["134653",5406.43,2712459700,27115512469,0],["134758",5407.2,2726270800,27250920941,0],["134853",5406.63,2739408300,27366029254,0],["134958",5406.16,2753144700,27501233310,0],["135058",5407.87,2765287100,27612982881,0],["135153",5409.08,2776339300,27727255926,0],["135258",5412.1,2789546500,27856172910,0],["135348",5413.25,2799747400,27961430803,0],["135453",5416.2,2816413600,28112453867,0],["135553",5418.44,2828115700,28227044575,0],["135653",5417.66,2843175600,28375166321,0],["135758",5416.22,2856092600,28508050470,0],["135858",5410.95,2872863500,28660557163,0],["135958",5409.59,2886535600,28792374264,0],["140058",5408.34,2898510400,28902607663,0],["140153",5409.24,2907051800,28998707453,0],["140248",5408.46,2915879600,29090317919,0],["140353",5405.84,2929428700,29223269833,0],["140453",5404,2942731000,29354962405,0],["140548",5404.04,2953782900,29462250822,0],["140658",5402.93,2967827400,29593127389,0],["140758",5404.17,2984799400,29733442386,0],["140853",5403.5,2993232800,29813245881,0],["140958",5403.52,3004315300,29920309314,0],["141053",5397.27,3023978200,30103653285,0],["141158",5389.25,3063115500,30489904730,0],["141258",5386.31,3102430800,30847836469,0],["141348",5385,3125732300,31063808674,0],["141448",5383.1,3150019800,31296477019,0],["141553",5381.88,3176116300,31541890100,0],["141653",5380.42,3198918400,31758551791,0],["141748",5381.35,3216357500,31913983486,0],["141858",5376.18,3250235900,32211449252,0],["141948",5377.41,3271813700,32403040277,0],["142058",5380.39,3291620100,32568070048,0],["142153",5382.54,3308014400,32721444840,0],["142253",5385.82,3321979300,32855221019,0],["142358",5388.4,3336287400,32996704134,0],["142458",5390.28,3351673800,33134935900,0],["142558",5391.64,3366887600,33277325709,0],["142658",5382.64,3398055400,33552239748,0],["142758",5384.83,3418417300,33737373427,0],["142853",5384.63,3431386300,33873210535,0],["142948",5387.02,3446660600,34012001104,0],["143048",5389.9,3459267400,34141991554,0],["143158",5390.03,3472662300,34282379322,0],["143258",5388.31,3486527700,34414170128,0],["143358",5389.06,3498802700,34529043180,0],["143458",5389.69,3510698300,34640904628,0],["143548",5390.75,3522998300,34747960455,0],["143658",5391.02,3537931900,34890884245,0],["143753",5386.74,3555101800,35044225852,0],["143848",5386.73,3571468000,35207376431,0],["143953",5387.21,3590412600,35390083386,0],["144053",5386.25,3610720000,35579219765,0],["144158",5387.5,3631320600,35773207639,0],["144258",5388.81,3646093500,35918296383,0],["144353",5390.82,3659905100,36061498276,0],["144453",5388.46,3674992600,36210611795,0],["144548",5389.47,3692489200,36369546582,0],["144648",5391.16,3706270300,36504340765,0],["144753",5390.44,3724511500,36671005863,0],["144848",5391.22,3739686200,36828121640,0],["144958",5391.42,3761218100,37021559829,0],["145053",5391.31,3776576000,37168129905,0],["145153",5393.05,3796896200,37361093226,0],["145258",5392.25,3819355700,37568784676,0],["145358",5391.01,3841884800,37796458837,0],["145448",5391.17,3862578500,37985973436,0],["145553",5392.29,3885458300,38202803648,0],["145658",5392.18,3911849900,38440624106,0],["145758",5391.91,3936627000,38673918479,0],["145858",5390.36,3965712000,38940497762,0],["145958",5391.37,3993131300,39183114970,0],["150000",5390.75,3995355300,39202628817,0]]},"previous":"1A0001","next":"2A0001","date":"20130607","openPrice":5475.475,"closePrice":5476.641,"version":"2.0"}');
    startDrawMline(canvasNewMlineWebBig, wtypeMline, dataMline, mtype, scaleM);
  } else {
    showError();
  }

  if (canvasNewMlineWebSmall && canvasNewMlineWebSmall.getContext && ((pr && pr >= 1.5) || window.screen.width >= 480)) {
    canvasNewMlineWebSmall.setAttribute('height', parseInt(275 * pr, 10));
    canvasNewMlineWebSmall.setAttribute('width', parseInt(595 * pr, 10));
    canvasNewMlineWebSmall.style.height = '275px';
    canvasNewMlineWebSmall.style.width = '595px';
    wtypeMline = 'webAppSmall';
    startDrawMline(canvasNewMlineWebSmall, wtypeMline, dataMline, mtype, scaleM);
  } else {
    showError();
  }

  if (canvasNewWebAppMainPage && canvasNewWebAppMainPage.getContext && ((pr && pr >= 1.5) || window.screen.width >= 480)) {
    canvasNewWebAppMainPage.setAttribute('height', parseInt(190 * pr, 10));
    canvasNewWebAppMainPage.setAttribute('width', parseInt(405 * pr, 10));
    canvasNewWebAppMainPage.style.height = '190px';
    canvasNewWebAppMainPage.style.width = '405px';
    wtypeMline = 'webAppMainPage';
    startDrawMline(canvasNewWebAppMainPage, wtypeMline, dataMline, mtype, scaleM);
  } else {
    showError();
  }

  if (canvasNewWebAppTrend && canvasNewWebAppTrend.getContext && ((pr && pr >= 1.5) || window.screen.width >= 480)) {
    canvasNewWebAppTrend.setAttribute('height', parseInt(100 * pr, 10));
    canvasNewWebAppTrend.setAttribute('width', parseInt(216 * pr, 10));
    canvasNewWebAppTrend.style.height = '100px';
    canvasNewWebAppTrend.style.width = '216px';
    wtypeMline = 'webAppTrend';
    // dataMline = JSON.parse('{"stockInfo":{"dataKey":["stockID","orgStockID","stockName","marketType","stockType","stockStatus","is_index"],"dataValue":["002498","002498","汉缆股份","SZ",",ZA,ZZX,","0","N"]},"mUnit":{"dataKey":["time","price","volum","amount"],"dataValue":[["093040",8.58,84,72040],["093155",8.55,159,136235],["093252",8.57,310,266290],["093352",8.58,388,333188],["093449",8.58,483,414557],["093549",8.59,513,439932],["093658",8.6,647,555367],["093737",8.57,649,556687],["093840",8.58,679,582427],["093955",8.56,825,708283],["094052",8.57,865,742150],["094143",8.6,906,777153],["094249",8.59,949,814619],["094349",8.59,972,833809],["094446",8.59,1028,882407],["094558",8.6,1138,976591],["094658",8.59,1168,1002834],["094758",8.58,1555,1334728],["094858",8.58,1566,1344231],["094946",8.59,1584,1359762],["095055",8.58,1636,1404359],["095155",8.59,1680,1442529],["095255",8.59,1689,1449932],["095343",8.59,1699,1458986],["095455",8.6,1747,1499908],["095555",8.61,1797,1543110],["095658",8.61,1879,1613342],["095752",8.62,1917,1646096],["095852",8.62,1975,1696556],["095955",8.61,1987,1706898],["100052",8.62,2080,1787150],["100152",8.62,2161,1856640],["100255",8.62,2175,1868743],["100352",8.61,2225,1912134],["100449",8.6,2340,2010644],["100558",8.61,2342,2012434],["100658",8.61,2430,2088664],["100758",8.62,2516,2162883],["100858",8.62,2545,2187487],["100958",8.65,2628,2258816],["101055",8.64,2724,2341952],["101158",8.64,2871,2469037],["101258",8.63,2909,2502297],["101358",8.64,2945,2532999],["101452",8.63,2948,2536054],["101552",8.63,3014,2593069],["101655",8.63,3056,2629211],["101758",8.63,3140,2701306],["101852",8.63,3186,2741176],["101955",8.63,3186,2741642],["102043",8.63,3199,2752464],["102131",8.63,3200,2753793],["102240",8.63,3290,2831221],["102313",8.62,3291,2831687],["102443",8.62,3294,2834738],["102552",8.62,3325,2861064],["102640",8.62,3400,2926041],["102755",8.62,3426,2948194],["102855",8.63,3464,2981289],["102955",8.64,3604,3101722],["103058",8.63,3604,3102188],["103137",8.63,3605,3102654],["103252",8.62,3786,3258706],["103349",8.61,3833,3299658],["103446",8.62,3838,3303175],["103546",8.62,3838,3303641],["103649",8.62,3850,3313573],["103725",8.62,3850,3314039],["103858",8.63,3865,3326592],["103958",8.64,3958,3407360],["104058",8.64,3974,3421189],["104146",8.64,4006,3448418],["104249",8.64,4036,3474804],["104355",8.65,4117,3544928],["104449",8.65,4187,3605079],["104546",8.65,4195,3612466],["104649",8.65,4205,3620718],["104749",8.65,4216,3629834],["104849",8.65,4234,3645871],["104946",8.63,4412,3799179],["105055",8.63,4433,3817839],["105155",8.63,4441,3824743],["105249",8.63,4487,3863991],["105346",8.64,4497,3873097],["105452",8.63,4508,3882002],["105546",8.64,4540,3910116],["105646",8.64,4551,3919222],["105755",8.64,4587,3950827],["105846",8.66,4614,3974256],["105958",8.65,4628,3986457],["110058",8.66,4653,4008107],["110158",8.66,4702,4050555],["110255",8.68,4791,4127783],["110349",8.68,4836,4166843],["110452",8.68,4904,4225880],["110555",8.68,4958,4272694],["110658",8.68,5028,4333415],["110752",8.69,5154,4442864],["110859",8.69,5261,4535827],["110947",8.68,5301,4570577],["111056",8.67,5339,4603306],["111150",8.69,5368,4628266],["111247",8.66,5411,4666003],["111356",8.66,5449,4698891],["111453",8.66,5470,4716367],["111556",8.67,5519,4759292],["111653",8.67,5539,4776907],["111753",8.68,5619,4846010],["111850",8.68,5628,4853822],["111950",8.67,5647,4870291],["112056",8.68,5656,4878103],["112147",8.68,5665,4885915],["112253",8.67,5728,4940546],["112359",8.68,5767,4974181],["112456",8.7,5961,5142742],["112559",8.72,6117,5278832],["112653",8.72,6161,5317214],["112759",8.71,6409,5533327],["112859",8.69,6497,5609841],["112956",8.72,6710,5795881],["130057",8.73,6918,5976987],["130157",8.72,6990,6039852],["130248",8.72,7000,6048572],["130357",8.71,7034,6078236],["130454",8.72,7082,6120082],["130551",8.72,7102,6137517],["130645",8.7,7150,6179277],["130754",8.69,7215,6235782],["130857",8.69,7265,6279242],["130942",8.69,7265,6279242],["131036",8.69,7309,6317478],["131139",8.69,7325,6331376],["131245",8.69,7330,6335721],["131351",8.69,7752,6702069],["131442",8.69,7752,6702069],["131557",8.69,7753,6702938],["131648",8.69,7786,6731615],["131739",8.69,7800,6743781],["131854",8.7,7879,6812467],["131954",8.73,7917,6845584],["132054",8.71,7984,6903961],["132151",8.71,8054,6964931],["132251",8.7,8060,6970151],["132342",8.71,8100,7004991],["132424",8.71,8161,7058097],["132533",8.72,8211,7101687],["132657",8.72,8234,7121731],["132754",8.71,8240,7126957],["132854",8.7,8271,7153930],["132948",8.69,8315,7192202],["133057",8.71,8387,7254888],["133151",8.69,8429,7291401],["133257",8.7,8551,7397459],["133348",8.69,8561,7406147],["133451",8.69,8566,7410492],["133548",8.69,8592,7433086],["133651",8.69,8657,7489630],["133751",8.7,8663,7494850],["133851",8.69,8683,7512230],["133954",8.7,8747,7567907],["134057",8.7,8972,7763070],["134151",8.69,9003,7790009],["134251",8.71,9286,8036301],["134348",8.72,9364,8104237],["134454",8.68,9505,8227016],["134557",8.7,9519,8239207],["134651",8.71,9577,8290155],["134757",8.71,9585,8297117],["134845",8.7,9738,8429792],["134954",8.69,9758,8447172],["135048",8.69,9758,8447172],["135157",8.71,9772,8459793],["135242",8.69,9855,8531519],["135333",8.69,9855,8531519],["135442",8.69,9915,8583659],["135554",8.69,9915,8583659],["135654",8.69,9916,8584528],["135751",8.68,9944,8608832],["135857",8.68,9982,8641816],["135930",8.68,10006,8662648],["140036",8.68,10037,8689536],["140148",8.69,10056,8706035],["140254",8.69,10298,8916768],["140346",8.7,10459,9056403],["140455",8.72,10597,9176698],["140552",8.72,10681,9250011],["140655",8.72,10712,9277043],["140755",8.72,10734,9296260],["140855",8.72,10876,9420302],["140958",8.75,11094,9611037],["141058",8.75,11094,9611037],["141155",8.75,11134,9646037],["141258",8.75,11170,9677896],["141358",8.75,11192,9697081],["141455",8.76,11248,9746122],["141549",8.75,11291,9783721],["141655",8.73,11315,9804673],["141731",8.72,11375,9856993],["141858",8.72,11375,9856993],["141958",8.71,11547,10006755],["142055",8.7,11584,10038945],["142146",8.73,11620,10070391],["142234",8.73,11631,10079994],["142343",8.72,11683,10125321],["142458",8.72,11685,10127065],["142540",8.72,11685,10127065],["142655",8.7,11687,10128805],["142752",8.7,11688,10129675],["142843",8.71,11721,10158415],["142958",8.72,11900,10314199],["143055",8.72,11949,10356946],["143152",8.74,11985,10388426],["143258",8.74,12015,10414646],["143358",8.74,12059,10453102],["143452",8.73,12140,10524263],["143555",8.72,12232,10604732],["143658",8.76,12324,10685219],["143746",8.76,12396,10748346],["143855",8.76,12439,10786014],["143958",8.76,12469,10812294],["144055",8.78,12578,10907955],["144158",8.77,12594,10921987],["144255",8.76,12726,11037611],["144355",8.8,12969,11250661],["144455",8.8,12995,11273529],["144546",8.8,12999,11277049],["144658",8.79,13051,11322737],["144755",8.8,13226,11476714],["144855",8.79,13304,11545298],["144958",8.79,13304,11545298],["145055",8.78,13305,11546176],["145155",8.78,13336,11573385],["145249",8.78,13377,11609383],["145346",8.79,13397,11626959],["145458",8.79,13818,11997068],["145558",8.8,13950,12113042],["145658",8.78,14252,12378486],["145701",8.78,14252,12378486],["150000",8.78,14252,12378486],["150000",8.78,14252,12378486],["150000",8.79,14370,12482208]]},"previous":"1A0001","next":"2A0001","date":"20120928","openPrice":8.59,"closePrice":8.63,"version":"2.0"}');
    startDrawMline(canvasNewWebAppTrend, wtypeMline, dataMline, mtype, scaleM);
  } else {
    showError();
  }


  if (canvasMlineWeb.getContext) {
    canvasMlineWeb.setAttribute('height', parseInt(265 * pr, 10));
    canvasMlineWeb.setAttribute('width', parseInt(300 * pr, 10));
    canvasMlineWeb.style.height = '265px';
    canvasMlineWeb.style.width = '300px';
    wtypeMline = 'web';
    startDrawMline(canvasMlineWeb, wtypeMline, dataMline, mtype, scaleM);
  } else {
    showError();
  }

  if (canvasMlineGupiao123.getContext) {
    canvasMlineGupiao123.setAttribute('height', parseInt(130 * pr, 10));
    canvasMlineGupiao123.setAttribute('width', parseInt(220 * pr, 10));
    canvasMlineGupiao123.style.height = '130px';
    canvasMlineGupiao123.style.width = '220px';
    wtypeMline = 'gupiao123';
    startDrawMline(canvasMlineGupiao123, wtypeMline, dataMline, mtype, scaleM);
  } else {
    showError();
  }

  if (canvasMlineGupiao123Big.getContext) {
    canvasMlineGupiao123Big.setAttribute('height', parseInt(273 * pr, 10));
    canvasMlineGupiao123Big.setAttribute('width', parseInt(400 * pr, 10));
    canvasMlineGupiao123Big.style.height = '273px';
    canvasMlineGupiao123Big.style.width = '400px';
    wtypeMline = 'gupiao123Big';
    startDrawMline(canvasMlineGupiao123Big, wtypeMline, dataMline, mtype, scaleM);
  } else {
    showError();
  }

  if (canvasMlineGupiao123V3 && canvasMlineGupiao123V3.getContext && ((pr && pr >= 1.5) || window.screen.width >= 480)) {
    canvasMlineGupiao123V3.setAttribute('height', parseInt(180 * pr, 10));
    canvasMlineGupiao123V3.setAttribute('width', parseInt(300 * pr, 10));
    canvasMlineGupiao123V3.style.height = '180px';
    canvasMlineGupiao123V3.style.width = '300px';
    wtypeMline = 'gupiao123V3';
    startDrawMline(canvasMlineGupiao123V3, wtypeMline, dataMline, mtype, scaleM);
  } else {
    showError();
  }

  if (canvasMlineGupiao123V3Big.getContext) {
    canvasMlineGupiao123V3Big.setAttribute('height', parseInt(360 * pr, 10));
    canvasMlineGupiao123V3Big.setAttribute('width', parseInt(600 * pr, 10));
    canvasMlineGupiao123V3Big.style.height = '360px';
    canvasMlineGupiao123V3Big.style.width = '600px';
    wtypeMline = 'gupiao123V3Big';
    startDrawMline(canvasMlineGupiao123V3Big, wtypeMline, dataMline, mtype, scaleM);
  } else {
    showError();
  }

} // end function draw